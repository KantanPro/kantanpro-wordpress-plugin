# KTPWP ユーザーマニュアル

## 概要

KTPWPは、WordPress上で動作する包括的なビジネス管理プラグインです。
受注処理から顧客管理、レポート作成まで、ビジネスに必要な機能を一元管理できます。

## 基本設定

### 1. インストール

1. プラグインファイルを `/wp-content/plugins/` ディレクトリにアップロード
2. WordPress管理画面の「プラグイン」から「KTPWP」を有効化
3. 固定ページに `[ktpwp_all_tab]` ショートコードを挿入

### 2. 初期設定

管理画面の「KTPWP設定」から以下を設定してください：
- 基本会社情報
- 表示件数設定
- メール設定（SMTP）
- デザイン設定

## 機能別マニュアル

## 1. 仕事リスト

**目的**: 受注案件の進捗管理とステータス追跡

### 主な機能
- 進捗別の案件表示（6段階）
- プロジェクト名による識別
- 担当者・顧客情報の確認
- 進捗ステータスの変更

### 進捗ステータス
1. **受付中** - 新規受注、内容確認中
2. **見積中** - 見積作成・提案中  
3. **作成中** - 作業実行中
4. **完成未請求** - 作業完了、請求書未発行
5. **請求済** - 請求書発行済み
6. **入金済** - 支払い完了

### 操作方法
- 進捗ボタンクリックで該当ステータスの案件を表示
- 案件名クリックで詳細画面へ移動
- プルダウンで進捗ステータスを直接変更

---

## 2. 伝票処理

**目的**: 受注書の作成・編集・印刷・請求項目管理

### 主な機能
- 新規受注書の作成
- 顧客・サービス情報の登録
- 請求項目とコスト項目の管理
- 受注書のプレビュー・印刷
- スタッフ間チャット機能

### 操作手順

#### 新規受注書作成
1. 「新規受注書作成」ボタンをクリック
2. 顧客情報を選択または新規入力
3. プロジェクト名・担当者名を入力
4. 進捗ステータスを設定
5. 「更新」ボタンで保存

#### 請求項目の追加
1. 「請求項目」セクションで「+」ボタンをクリック
2. サービス名・単価・数量・単位を入力
3. 「追加」ボタンで項目を追加
4. 合計金額が自動計算される

#### 印刷機能
1. プレビューボタンで印刷イメージを確認
2. 印刷ボタンで受注書を印刷
3. レイアウトは設定画面でカスタマイズ可能

---

## 3. 得意先

**目的**: 顧客情報の管理と注文履歴の表示

### 主な機能
- 顧客基本情報の管理
- 支払条件・締日の設定
- 顧客別注文履歴の表示
- 宛名印刷機能
- 対象・対象外の管理

### 顧客情報項目
- **基本情報**: 会社名、担当者名、代表者名
- **連絡先**: 電話番号、メールアドレス、URL
- **住所**: 郵便番号、都道府県、市区町村、番地、建物名
- **支払条件**: 締日、支払月、支払日、支払方法
- **その他**: カテゴリー、メモ、対象ステータス

### 操作方法

#### 新規顧客登録
1. 「追加」モードを選択
2. 必須項目（会社名）を入力
3. その他項目を必要に応じて入力
4. 「追加実行」ボタンで保存

#### 顧客情報編集
1. 顧客リストから対象顧客をクリック
2. 情報を編集
3. 「更新」ボタンで保存

#### 注文履歴表示
1. 顧客詳細画面で「注文履歴を表示」をクリック
2. 該当顧客の全受注履歴が表示
3. 各注文をクリックして詳細確認

---

## 4. サービス

**目的**: サービス・商品マスターの管理と価格設定

### 主な機能
- サービス名・価格・単位の管理
- カテゴリー別分類
- 頻度データによる利用状況把握
- 受注書への簡単追加

### サービス情報項目
- **基本情報**: サービス名（必須）、価格、単位
- **分類**: カテゴリー
- **管理情報**: 頻度、メモ
- **履歴**: 登録日時

### 操作方法

#### 新規サービス登録
1. 「追加」モードを選択
2. サービス名（必須）を入力
3. 価格・単位・カテゴリーを設定
4. 「追加実行」ボタンで保存

#### サービス編集
1. サービスリストから対象サービスをクリック
2. 情報を編集
3. 「更新」ボタンで保存

#### カテゴリー管理
- 自由なカテゴリー名を設定可能
- 既存カテゴリーは自動提案される
- ソート機能でカテゴリー別表示

---

## 5. 協力会社

**目的**: 仕入先・外注先情報の管理と支払条件設定

### 主な機能
- 協力会社基本情報の管理
- 支払条件・税区分の設定
- カテゴリー分類と検索
- 取引履歴の管理

### 協力会社情報項目
- **基本情報**: 会社名、担当者名、代表者名
- **連絡先**: 電話番号、メールアドレス、URL
- **住所**: 郵便番号、都道府県、市区町村、番地、建物名
- **支払条件**: 締日、支払月、支払日、支払方法
- **税務情報**: 税区分
- **管理情報**: カテゴリー、メモ、頻度

### 操作方法

#### 新規協力会社登録
1. 「追加」モードを選択
2. 会社名（必須）を入力
3. 支払条件・税区分を設定
4. 「追加実行」ボタンで保存

#### 協力会社情報編集
1. 協力会社リストから対象をクリック
2. 情報を編集
3. 「更新」ボタンで保存

#### 検索・フィルタリング
- 会社名・カテゴリーで検索
- ソート機能で効率的な管理

---

## 6. レポート

**目的**: 売上分析・進捗状況・データ集計

### 主な機能
- 売上推移グラフ
- 進捗別受注件数の集計
- 顧客別売上分析
- 月次・年次レポート

### レポート種類

#### 売上レポート
- 月別売上推移
- 顧客別売上ランキング
- サービス別売上分析
- 年次売上サマリー

#### 進捗レポート
- ステータス別案件数
- 完了率の推移
- 平均処理時間
- 滞留案件の特定

#### 運用レポート
- 新規顧客獲得推移
- サービス利用頻度
- 協力会社利用状況

### 操作方法
1. レポートタブを選択
2. 期間・条件を設定
3. グラフ・表形式で結果を確認
4. 必要に応じてデータをエクスポート

---

## 7. 設定

**目的**: 宛名印刷テンプレート・システム設定

### 主な機能

#### 宛名印刷テンプレート
- 顧客住所情報の自動置換
- カスタムテンプレート作成
- プレビュー機能
- 印刷レイアウトの調整

#### システム設定
- 表示件数の設定
- デフォルト値の設定
- セキュリティ設定

### 宛名印刷の使用方法

#### テンプレート作成
1. 設定タブの「宛名印刷テンプレート」を選択
2. エディターでレイアウトを作成
3. 置換ワードを使用して動的データを設定

#### 置換ワード一覧
- `_%postal_code%_` - 郵便番号
- `_%prefecture%_` - 都道府県
- `_%city%_` - 市区町村
- `_%address%_` - 番地
- `_%building%_` - 建物名
- `_%customer%_` - 会社名｜屋号｜お名前
- `_%user_name%_` - 担当者名

#### テンプレート保存・プレビュー
1. テンプレート編集後、「更新」ボタンをクリック
2. プレビューボタンで印刷イメージを確認
3. 顧客データが自動的に置換されて表示

---

## 便利な機能

### ソート・検索機能
- 各リストは複数の条件でソート可能
- ID、名前、日付、カテゴリー、頻度等
- 昇順・降順の切り替え
- キーワード検索機能

### ページネーション
- 大量データも快適に表示
- 設定で1ページあたりの表示件数を調整
- 最初・前・次・最後への移動ボタン

### プレビュー機能
- 受注書印刷前のレイアウト確認
- 宛名印刷のテンプレート確認
- リアルタイムプレビュー

### レスポンシブデザイン
- PC・タブレット・スマートフォン対応
- 画面サイズに応じた最適化表示
- タッチデバイスでの操作性向上

---

## セキュリティ

### 実装済みセキュリティ対策
- **SQLインジェクション防止**: 全てのデータベースクエリで適切なエスケープ処理
- **XSS保護**: 出力データの適切なサニタイズ
- **CSRF対策**: フォーム送信時のnonce検証
- **ファイルアップロード検証**: 安全なファイル形式のみ許可
- **ユーザー権限制御**: WordPress標準の権限システムを活用

### 推奨セキュリティ対策
- 定期的なWordPressとプラグインの更新
- 強固なログインパスワードの設定
- SSL証明書の使用
- 定期的なデータベースバックアップ

---

## トラブルシューティング

### よくある問題と解決方法

#### Q: ショートコードを挿入してもタブが表示されない
A: 以下を確認してください：
- プラグインが有効化されているか
- ショートコード `[ktpwp_all_tab]` が正しく入力されているか
- 固定ページに挿入されているか（投稿ではなく）

#### Q: データが保存されない
A: 以下を確認してください：
- ユーザーに適切な権限があるか
- ブラウザのJavaScriptが有効になっているか
- 他のプラグインとの競合がないか

#### Q: 印刷レイアウトが崩れる
A: 以下をお試しください：
- ブラウザの印刷設定を確認
- CSS印刷スタイルの調整
- プレビュー機能での事前確認

#### Q: 大量データの表示が遅い
A: 以下で改善される場合があります：
- 表示件数の調整（設定画面）
- 古いデータの整理
- サーバーのメモリ増設

---

## サポート情報

### 公式リソース
- **公式サイト**: https://ktpwp.com/
- **ブログ**: https://ktpwp.com/blog/
- **WordPressサポートフォーラム**: https://wordpress.org/support/

### システム要件
- WordPress 5.0 以上
- PHP 7.4 以上
- MySQL 5.6 以上 または MariaDB 10.0 以上
- 推奨メモリ: 256MB 以上

### 開発者情報
- **開発者**: Kantan Pro
- **バージョン**: beta
- **ライセンス**: GPL v2 or later

---

## 更新履歴

### beta版
- 7つの主要機能タブの実装完了
- セキュリティ対策の全面実装
- レスポンシブデザイン対応
- 印刷・プレビュー機能の実装
- 本番環境での使用に最適化

---

*このマニュアルは KTPWP beta版 に基づいて作成されています。*
*最新の情報については、公式サイトをご確認ください。*
